{
  "groups": [
    {
      "name": "slo-breaches",
      "rules": [
        {
          "alert": "LatencySLOBreach",
          "expr": "histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) > 0.2",
          "for": "2m",
          "labels": {
            "severity": "critical",
            "service": "signal-service",
            "component": "latency"
          },
          "annotations": {
            "summary": "Latency SLO breach detected",
            "description": "P95 request latency is {{ $value }}s, above 200ms SLO threshold for 2 minutes.",
            "runbook_url": "https://docs.signal-service.com/runbooks/latency-slo-breach"
          }
        },
        {
          "alert": "ErrorRateSLOBreach",
          "expr": "rate(http_requests_total{status=~\"4..|5..\"}[5m]) / rate(http_requests_total[5m]) * 100 > 0.1",
          "for": "2m",
          "labels": {
            "severity": "critical",
            "service": "signal-service",
            "component": "errors"
          },
          "annotations": {
            "summary": "Error rate SLO breach detected",
            "description": "Error rate is {{ $value }}%, above 0.1% SLO threshold for 2 minutes.",
            "runbook_url": "https://docs.signal-service.com/runbooks/error-rate-slo-breach"
          }
        },
        {
          "alert": "High5xxErrorRate",
          "expr": "rate(http_requests_total{status=~\"5..\"}[5m]) / rate(http_requests_total[5m]) * 100 > 1",
          "for": "1m",
          "labels": {
            "severity": "critical",
            "service": "signal-service",
            "component": "server-errors"
          },
          "annotations": {
            "summary": "High 5xx error rate detected",
            "description": "5xx error rate is {{ $value }}%, above 1% threshold for 1 minute.",
            "runbook_url": "https://docs.signal-service.com/runbooks/high-5xx-errors"
          }
        },
        {
          "alert": "P99LatencyDegraded",
          "expr": "histogram_quantile(0.99, rate(http_request_duration_seconds_bucket[5m])) > 0.5",
          "for": "5m",
          "labels": {
            "severity": "warning",
            "service": "signal-service",
            "component": "latency"
          },
          "annotations": {
            "summary": "P99 latency degraded",
            "description": "P99 request latency is {{ $value }}s, above 500ms threshold for 5 minutes.",
            "runbook_url": "https://docs.signal-service.com/runbooks/p99-latency-degraded"
          }
        },
        {
          "alert": "LowThroughput",
          "expr": "rate(http_requests_total[5m]) < 10",
          "for": "5m",
          "labels": {
            "severity": "warning",
            "service": "signal-service",
            "component": "throughput"
          },
          "annotations": {
            "summary": "Low throughput detected",
            "description": "Request throughput is {{ $value }} RPS, below 10 RPS threshold for 5 minutes.",
            "runbook_url": "https://docs.signal-service.com/runbooks/low-throughput"
          }
        }
      ]
    }
  ]
}